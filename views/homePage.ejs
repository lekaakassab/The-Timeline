<!DOCTYPE html>
<html>
<head>
  <title>Timeline</title>
  <link rel="stylesheet" href="/style.css">
</head>
<body>

<h1>Timeline</h1>

<form method="POST" action="/posts">
  <textarea name="post" rows="4" cols="40" placeholder="Write your post..."></textarea>
  <br>
  <button type="submit">Add Post</button>
</form>

<hr>

<% posts.forEach(function(p){ %>

  <p><strong>Date:</strong> <%= new Date(p.createdAt).toDateString() %></p>

  <p><%= p.post %></p>

  <form method="POST" action="/posts/<%= p._id %>/update">
    <textarea name="post" rows="3" cols="40"><%= p.post %></textarea>
    <br>
    <button type="submit">Update</button>
  </form>

  <form method="POST" action="/posts/<%= p._id %>/delete">
    <button type="submit">Delete</button>
  </form>

  <hr>
  <div class="comments-form">
    <form method="post" action="/post/add/new-comment/<%= p._id %>">
      <input type="text" placeholder="comment......." autocomplete="off" name="body">
      <input type="hidden" value="">
      <button>Add comment</button>
    </form>
  </div>

  <div class="comments-container">
    <% if (p.comments.length > 0) { %>
      <% p.comments.forEach(function(c){ %>
        <div class="comment-section">
          <h4><%= c.body %></h4>

          <form method="POST" action="/comments/<%= c._id %>/delete">
            <button type="submit">Delete</button>
          </form>

        </div>
      <% }); %>
    <% } %>
  </div>

<% }); %>

</body>
</html>